# 图书管理系统 - 测试用例设计文档

## 📊 测试用例总体分类

本文档包含 **58 个测试用例**，分为三个层次：

| 层次 | 类型 | 用例数 | 实现方式 | 状态 |
|------|------|--------|--------|------|
| **单元测试** | JUnit | **58** ✅ | 自动化测试代码 | **已完成** |
| **合计** | | **58** | | |

---

## ✅ 已实现的JUnit单元测试 (58个)

| 用例ID | 场景 | 输入 | 预期输出 | 实际结果 | 通过 |
|--------|------|------|---------|---------|------|
| TC-B001 | 搜索图书成功 | keyword="Java" | 返回包含"Java"的2本书 | ✅ 通过 | 是 |
| TC-B002 | 搜索图书无结果 | keyword="NotExist" | 返回空列表 | ✅ 通过 | 是 |
| TC-B003 | 搜索关键字为空 | keyword="" | 返回空列表 | ✅ 通过 | 是 |
| TC-B004 | 按ID查找图书存在 | bookId=1 | 返回对应图书对象 | ✅ 通过 | 是 |
| TC-B005 | 按ID查找图书不存在 | bookId=999 | 返回null | ✅ 通过 | 是 |
| TC-B006 | 检查库存可用 | bookId=1, stock=5 | 返回true | ✅ 通过 | 是 |
| TC-B007 | 库存为0时查询可用 | bookId=1, stock=0 | 返回false | ✅ 通过 | 是 |
| TC-B008 | 查询不存在的图书可用性 | bookId=999 | 返回false | ✅ 通过 | 是 |
| TC-B009 | 减少库存成功 | bookId=1, stock=5 | stock变为4，save被调用1次 | ✅ 通过 | 是 |
| TC-B010 | 库存为0时减少 | bookId=1, stock=0 | stock保持0，save不被调用 | ✅ 通过 | 是 |
| TC-B011 | 减少不存在图书库存 | bookId=999 | save不被调用 | ✅ 通过 | 是 |
| TC-B012 | 增加库存成功 | bookId=1, stock=3 | stock变为4，save被调用1次 | ✅ 通过 | 是 |
| TC-B013 | 增加不存在图书库存 | bookId=999 | save不被调用 | ✅ 通过 | 是 |
| TC-B014 | 保存图书成功 | title="新书", author="新作者" | 返回保存后的图书对象 | ✅ 通过 | 是 |
| TC-B015 | 删除图书成功 | bookId=1 | deleteById被调用1次 | ✅ 通过 | 是 |
| TC-B016 | 查询所有图书 | 无输入 | 返回包含2本书的列表 | ✅ 通过 | 是 |
| TC-B017 | 获取图书总数 | 无输入 | 返回10 | ✅ 通过 | 是 |
| TC-B018 | 创建新图书 | 完整图书信息 | 图书对象创建成功，字段完整 | ✅ 通过 | 是 |
| TC-B019 | 更新图书信息 | bookId=1, 新title | title更新成功 | ✅ 通过 | 是 |

---

## 二、用户服务测试用例 (UserService)

| 用例ID | 场景 | 输入 | 预期输出 | 实际结果 | 通过 |
|--------|------|------|---------|---------|------|
| TC-U001 | 用户注册成功 | username="user1", password="pwd123" | 返回注册成功的用户对象 | ✅ 通过 | 是 |
| TC-U002 | 注册用户名重复 | username="admin"(已存在) | 抛出RuntimeException | ✅ 通过 | 是 |
| TC-U003 | 注册设置默认角色 | 仅输入用户名密码 | role=USER，status=ACTIVE | ✅ 通过 | 是 |
| TC-U004 | 注册密码加密 | password="plaintext" | 保存的密码使用BCrypt加密 | ✅ 通过 | 是 |
| TC-U005 | 按用户名查找存在 | username="admin" | 返回admin用户对象 | ✅ 通过 | 是 |
| TC-U006 | 按用户名查找不存在 | username="notexist" | 返回null | ✅ 通过 | 是 |
| TC-U007 | 按ID查找存在 | userId=1 | 返回对应用户对象 | ✅ 通过 | 是 |
| TC-U008 | 按ID查找不存在 | userId=999 | 返回null | ✅ 通过 | 是 |
| TC-U009 | 密码验证成功 | username="admin", password="password" | 返回true | ✅ 通过 | 是 |
| TC-U010 | 密码验证失败 | username="admin", password="wrongpwd" | 返回false | ✅ 通过 | 是 |
| TC-U011 | 用户不存在验证密码 | username="notexist" | 抛出异常或返回false | ✅ 通过 | 是 |
| TC-U012 | 保存用户成功 | 有效用户对象 | 返回保存后的用户 | ✅ 通过 | 是 |
| TC-U013 | 删除用户成功 | userId=1 | deleteById被调用1次 | ✅ 通过 | 是 |
| TC-U014 | 查询所有用户 | 无输入 | 返回用户列表 | ✅ 通过 | 是 |
| TC-U015 | 获取用户总数 | 无输入 | 返回用户总数 | ✅ 通过 | 是 |
| TC-U016 | 生成密码哈希 | password="test123" | 返回BCrypt哈希字符串 | ✅ 通过 | 是 |
| TC-U017 | 多次哈希不同 | password="test123"，调用2次 | 两次哈希结果不同 | ✅ 通过 | 是 |
| TC-U018 | 密码检验异常处理 | 无效密码哈希 | 抛出异常被捕获 | ✅ 通过 | 是 |

---

## 三、借阅服务测试用例 (BorrowingService)

| 用例ID | 场景 | 输入 | 预期输出 | 实际结果 | 通过 |
|--------|------|------|---------|---------|------|
| TC-BR001 | 借书成功 | userId=1, bookId=1 | 创建Borrowing对象，库存-1 | ✅ 通过 | 是 |
| TC-BR002 | 图书不可用时借书 | userId=1, bookId=1(stock=0) | 抛出RuntimeException | ✅ 通过 | 是 |
| TC-BR003 | 设置应还日期14天 | 借书时间=now | dueDate=now+14天 | ✅ 通过 | 是 |
| TC-BR004 | 归还书籍成功 | borrowingId=1 | returnDate被设置，save被调用 | ✅ 通过 | 是 |
| TC-BR005 | 归还不存在记录 | borrowingId=999 | 抛出RuntimeException | ✅ 通过 | 是 |
| TC-BR006 | 重复归还同一记录 | 已归还的borrowingId | 抛出RuntimeException | ✅ 通过 | 是 |
| TC-BR007 | 按时归还不计罚款 | 在dueDate前归还 | fine=0 | ✅ 通过 | 是 |
| TC-BR008 | 逾期6天罚款 | 逾期6天归还 | fine=3.0 | ✅ 通过 | 是 |
| TC-BR009 | 查询用户借阅记录 | userId=1 | 返回该用户的所有借阅 | ✅ 通过 | 是 |
| TC-BR010 | 查询用户无借阅记录 | userId=999 | 返回空列表 | ✅ 通过 | 是 |
| TC-BR011 | 查询所有借阅记录 | 无输入 | 返回所有借阅记录 | ✅ 通过 | 是 |
| TC-BR012 | 获取借阅总数 | 无输入 | 返回借阅记录总数 | ✅ 通过 | 是 |
| TC-BR013 | 获取活跃借阅计数 | returnDate=null的记录 | 返回活跃借阅数量 | ✅ 通过 | 是 |
| TC-BR014 | 无活跃借阅 | 所有记录都已归还 | 返回0 | ✅ 通过 | 是 |
| TC-BR015 | 获取逾期记录 | 当前日期>dueDate且returnDate=null | 返回逾期的记录列表 | ✅ 通过 | 是 |
| TC-BR016 | 无逾期记录 | 所有记录未逾期 | 返回空列表 | ✅ 通过 | 是 |
| TC-BR017 | 获取逾期计数 | 有逾期记录 | 返回逾期数量 | ✅ 通过 | 是 |
| TC-BR018 | 获取热门图书 | 无输入 | 返回按借阅次数排序的图书 | ✅ 通过 | 是 |
| TC-BR019 | 无热门图书 | 没有借阅记录 | 返回空列表 | ✅ 通过 | 是 |
| TC-BR020 | 获取用户借阅统计 | 无输入 | 返回用户及借阅次数 | ✅ 通过 | 是 |
| TC-BR021 | 无用户借阅统计 | 没有借阅记录 | 返回空列表 | ✅ 通过 | 是 |

---

## 测试执行记录

### 执行人：GitHub Copilot  执行日期：2025-12-30  版本：v1.0

| 类别 | 总计 | 通过 | 失败 | 阻止 | 通过率 |
|------|------|------|------|------|--------|
| 图书服务 (BookServiceTest) | 19 | 19 | 0 | 0 | 100% |
| 用户服务 (UserServiceTest) | 18 | 18 | 0 | 0 | 100% |
| 借阅服务 (BorrowingServiceTest) | 21 | 21 | 0 | 0 | 100% |
| **合计** | **58** | **58** | **0** | **0** | **100%** |
